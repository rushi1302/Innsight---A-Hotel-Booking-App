1. add middleware function for authentication instaed of writing all code in controllers.